openapi: 3.0.3
info:
  title: View Self Assessment Account
  version: 0.3.0
servers:
  - url: https://test-api.service.hmrc.gov.uk
    description: Sandbox
  - url: https://api.service.hmrc.gov.uk
    description: Production
paths:
  /accounts/breakdown/self-assessment/{utr}:
    get:
      tags:
        - Self Assessment Account Details
      summary: Account Details
      description: |
        <b>Examples</b><br>
        /accounts/breakdown/self-assessment/1234567890/?fromDate=2024-08-04
      parameters:
        - in: header
          name: Authorization
          description: |
            An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
          required: true
          schema:
            type: string
            example: "Bearer bb7fed3fe10dd235a2ccda3d50fb"
        - in: query
          name: fromDate
          required: false
          description: |
            "The start date for the tax data retrieval period (YYYY-MM-DD format)"
          example: "2023-01-01"
          schema:
            $ref: "#/components/schemas/dateType"
        - $ref: '#/components/parameters/utr'
      responses:
        '200':
          description: Successful
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/successResponse'
              examples:
                example 1:
                  $ref: '#/components/examples/successResponseExample'
        '400':
          description: Bad request
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/responseType'
              examples:
                error400ResponseBodyExample:
                  $ref: '#/components/examples/error400ResponseBodyExample'
        "401":
          description: Unauthorised
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/responseType'
              examples:
                error401ResponseBodyExample:
                  $ref: '#/components/examples/error401ResponseBodyExample'
        "403":
          description: Forbidden
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/responseType'
              examples:
                error403ResponseBodyExample:
                  $ref: '#/components/examples/error403ResponseBodyExample'
        '404':
          description: Not found
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/responseType'
              examples:
                error404ResponseBodyExample:
                  $ref: '#/components/examples/error404ResponseBodyExample'
        '500':
          description: Internal Server Error
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/responseType'
              examples:
                error500ResponseBodyExample:
                  $ref: '#/components/examples/error500ResponseBodyExample'
        '503':
          description: Service unavailable
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/responseType'
              examples:
                error503ResponseBodyExample:
                  $ref: '#/components/examples/error503ResponseBodyExample'
      security:
        - userRestricted:
          - read:self-assessment
components:
  securitySchemes:
    userRestricted:
      type: oauth2
      description: HMRC supports OAuth 2.0 for authenticating user restricted API requests using an OAuth 2.0 Bearer Token in the AUTHORIZATION header.
        Please see the [developer hub](https://developer.service.hmrc.gov.uk/api-documentation/docs/authorisation/user-restricted-endpoints) for more details.
      flows:
        authorizationCode:
          authorizationUrl: https://api.service.hmrc.gov.uk/oauth/authorize
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          refreshUrl: https://api.service.hmrc.gov.uk/oauth/refresh
          scopes:
            read:self-assessment: Read self-assessment data
  headers:
    Authorization:
      description: An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
      schema:
        type: string
        example: Bearer bb7fed3fe10dd235a2ccda3d50fb
  parameters:
    fromDate:
      in: query
      name: fromDate
      example: "2023-01-01"
      schema:
        $ref: "#/components/schemas/dateType"
    utr:
      in: path
      name: utr
      required: true
      schema:
        allOf:
          - type: string
            pattern: ^\d{10}$
            example: 1234567890
      description: Unique Tax Payer Reference
  schemas:
    amountType_11_2:
      description: "Currency amount. 13-digits total with 2 decimal places"
      type: "number"
      minimum: -9.999999999999E10
      maximum: 9.999999999999E10
      multipleOf: 0.01
    dateType:
      allOf:
        - type: string
          pattern: ^(((19|20)([2468][048]|[13579][26]|0[48])|2000)[-]02[-]29|((19|20)[0-9]{2}[-](0[469]|11)[-](0[1-9]|1[0-9]|2[0-9]|30)|(19|20)[0-9]{2}[-](0[13578]|1[02])[-](0[1-9]|[12][0-9]|3[01])|(19|20)[0-9]{2}[-]02[-](0[1-9]|1[0-9]|2[0-8])))$
    responseType:
      allOf:
        - required:
            - failure
          type: object
          properties:
            failure:
              allOf:
                - type: object
                  required:
                    - type
                    - reason
                  properties:
                    type:
                      allOf:
                        - type: string
                    reason:
                      allOf:
                        - type: string
                  additionalProperties: false
    successResponse:
      type: object
      required:
        - balanceDetails
      description: Provides a summary of the taxpayer's current position
      properties:
        balanceDetails:
          allOf:
            - type: object
              properties:
                totalOverdueBalance:
                  description: "Total of all charges with a due date in the past."
                  allOf:
                    - $ref: "#/components/schemas/amountType_11_2"
                totalPayableBalance:
                  description: "Total of all charges due within the next 30 days."
                  allOf:
                    - $ref: "#/components/schemas/amountType_11_2"
                earliestPayableDueDate:
                  description: "The earliest due date for charges due within the next 30 days."
                  allOf:
                    - $ref: "#/components/schemas/dateType"
                totalPendingBalance:
                  description: "Total of all charges due in 30 days or more."
                  allOf:
                    - $ref: "#/components/schemas/amountType_11_2"
                earliestPendingDueDate:
                  description: "The earliest due date for charges due in 30 days or more."
                  allOf:
                    - $ref: "#/components/schemas/dateType"
                totalBalance:
                  description: "Combined total of overdue, payable, and pending charges."
                  allOf:
                    - $ref: "#/components/schemas/amountType_11_2"
                totalCreditAvailable:
                  description: "Total credit currently accrued on the account."
                  allOf:
                    - $ref: "#/components/schemas/amountType_11_2"
                codedOutDetail:
                  description: "Coded out liabilities"
                  allOf:
                    - type : array
                      items:
                        type: object
                        properties:
                          totalAmount:
                            description: "Total past/future amount adjustments via taxcode changes."
                            allOf:
                              - $ref: "#/components/schemas/amountType_11_2"
                          effectiveStartDate:
                            description: "Effective start date of coding"
                            allOf:
                              - $ref: "#/components/schemas/dateType"
                          effectiveEndDate:
                            description: "Effective end date of coding"
                            allOf:
                              - $ref: "#/components/schemas/dateType"
                        additionalProperties: false
                        required:
                          - totalAmount
                          - effectiveStartDate
                          - effectiveEndDate
              required:
                - totalOverdueBalance
                - totalPayableBalance
                - totalPendingBalance
                - totalBalance
                - totalCreditAvailable
        chargeDetails:
          allOf:
            - type: array
              items:
                description: "Provides a summary of historic charges and amendments made to a charge"
                allOf:
                  - required:
                      - chargeAmount
                      - chargeId
                      - chargeType
                      - creationDate
                      - dueDate
                      - outstandingAmount
                      - taxYear
                    type: object
                    properties:
                      accruingInterest:
                        description: "Interest currently accruing on the charge."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      accruingInterestPeriod:
                        description: "The date range over which interest applies to this charge."
                        allOf:
                          - type: object
                            properties:
                              interestStartDate:
                                allOf:
                                  - $ref: "#/components/schemas/dateType"
                              interestEndDate:
                                allOf:
                                  - $ref: "#/components/schemas/dateType"
                      accruingInterestRate:
                        description: "The current interest rate being applied."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      amendments:
                        allOf:
                          - type: array
                            items:
                              description: "Provides information about any adjustments made to a charge due to payments, credits or appeals."
                              allOf:
                                - required:
                                    - amendmentAmount
                                    - amendmentDate
                                    - amendmentReason
                                  type: object
                                  properties:
                                    amendmentDate:
                                      description: "Date the amendment was made."
                                      allOf:
                                        - $ref: "#/components/schemas/dateType"
                                    amendmentAmount:
                                      description: "Amount added or reduced from the outstanding charge amount."
                                      allOf:
                                        - $ref: "#/components/schemas/amountType_11_2"
                                    amendmentReason:
                                      description: "Reason the change was applied."
                                      allOf:
                                        - type: string
                                          minLength: 1
                                          maxLength: 100
                                    updatedChargeAmount:
                                      description: "Outstanding charge balance after an amendment."
                                      allOf:
                                        - $ref: "#/components/schemas/amountType_11_2"
                                    paymentMethod:
                                      description: "How the payment was made (e.g. bank transfer)."
                                      allOf:
                                        - type: string
                                          minLength: 1
                                          maxLength: 30
                                    paymentDate:
                                      description: "Date the payment was made."
                                      allOf:
                                        - $ref: "#/components/schemas/dateType"
                                  additionalProperties: false
                      chargeId:
                        description: "Unique identifier for the charge."
                        allOf:
                          - type: string
                            pattern: ^[0-9]{1,12}$
                      chargeType:
                        description: "Type of charge (e.g. ITSA, NICS, POA)."
                        allOf:
                          - type: string
                            minLength: 1
                            maxLength: 30
                      chargeAmount:
                        description: "The original amount of the charge."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      creationDate:
                        description: "Date the charge was created."
                        allOf:
                          - $ref: "#/components/schemas/dateType"
                      dueDate:
                        description: "Date the charge must be paid by."
                        allOf:
                          - $ref: "#/components/schemas/dateType"
                      outstandingInterestDue:
                        description: "Amount of interest unpaid from the total accrued interest."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      outstandingAmount:
                        description: "Remaining balance on the charge still to be paid."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      taxYear:
                        description: "The tax year the charge relates to."
                        allOf:
                          - $ref: "#/components/schemas/yearType"
                    additionalProperties: false
        refundDetails:
          allOf:
            - type: array
              items:
                description: "Information about refunds"
                allOf:
                  - type: object
                    required:
                      - refundDate
                      - totalRefundAmount
                      - refundRequestAmount
                    properties:
                      refundDate:
                        description: "The date that the refund was issued."
                        allOf:
                          - $ref: "#/components/schemas/dateType"
                      interestAddedToRefund:
                        description: "Any interest added to the refund at the point of processing."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      totalRefundAmount:
                        description: "The total amount refunded, including any added interest."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      refundMethod:
                        description: "The method that was used to make the refund (BACS etc)."
                        allOf:
                          - type: string
                            pattern: ^[a-zA-Z ]{1,30}$
                      refundDescription:
                        description: "Additional information about the refund."
                        allOf:
                          - type: string
                            pattern: ^[a-zA-Z0-9 ]{1,100}$
                      refundRequestAmount:
                        description: "The amount requested for refund."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      refundRequestDate:
                        description: "The date that the refund was requested."
                        allOf:
                          - $ref: "#/components/schemas/dateType"
                      refundStatus:
                        description: "The current progress of the refund."
                        allOf:
                          - type: string
                            pattern: ^[a-zA-Z ]{1,32}$
                    additionalProperties: false
        paymentHistoryDetails:
          allOf:
            - type: array
              items:
                description: "History of previous payments"
                allOf:
                  - type: object
                    required:
                      - paymentAmount
                      - paymentDate
                      - paymentReference
                    properties:
                      allocationReference:
                        description: "A list of charges this payment is allocated to."
                        allOf:
                          - type: string
                            minLength: 1
                            maxLength: 35
                      processedDate:
                        description: "The date the payment was processed by HMRC."
                        allOf:
                          - $ref: "#/components/schemas/dateType"
                      paymentAmount:
                        description: "The amount that was paid."
                        allOf:
                          - $ref: "#/components/schemas/amountType_11_2"
                      paymentMethod:
                        description: "How the payment was made (e.g. bank transfer, card)."
                        allOf:
                          - type: string
                            minLength: 1
                            maxLength: 30
                      paymentReference:
                        description: "The reference used for the payment."
                        allOf:
                          - type: string
                            minLength: 1
                            maxLength: 35
                      paymentDate:
                        description: "The date payment was made."
                        allOf:
                          - $ref: "#/components/schemas/dateType"
                    additionalProperties: false
      additionalProperties: false
    yearType:
      allOf:
        - type: string
          pattern: ^([0-9]{4})$
  examples:
    error400ResponseBodyExample:
      value:
        failure:
          type: BAD_REQUEST
          reason: Invalid request format or parameters.
    error401ResponseBodyExample:
      value:
        failure:
          type: UNAUTHORISED
          reason: Authorisation failed.
    error403ResponseBodyExample:
      value:
        failure:
          type: FORBIDDEN
          reason: Access not permitted.
    error404ResponseBodyExample:
      value:
        failure:
          type: NOT_FOUND
          reason: No data found for the UTR provided.
    error500ResponseBodyExample:
      value:
        failure:
          type: INTERNAL_SERVER_ERROR
          reason: Unexpected internal error. Please contact service desk.
    error503ResponseBodyExample:
      value:
        failure:
          type: SERVICE_UNAVAILABLE
          reason: Service unavailable. Please try again later.
    successResponseExample:
      value:
        balanceDetails:
          totalOverdueBalance: 500
          totalPayableBalance: 500
          earliestPayableDueDate: 2025-04-30
          totalPendingBalance: 1500
          earliestPendingDueDate: '2025-07-15'
          totalBalance: 2000
          totalCreditAvailable: 0
          codedOutDetail:
            - totalAmount: 200
              effectiveStartDate: 2023-04-06
              effectiveEndDate: 2024-04-01
        chargeDetails:
          - chargeId: AB1234567
            creationDate: '2025-01-15'
            chargeType: ITSA
            chargeAmount: 1250
            outstandingAmount: 500
            taxYear: 2024
            dueDate: 2025-04-30
            amendments:
              - amendmentDate: '2025-04-15'
                amendmentAmount: 500
                updatedChargeAmount: 750
                amendmentReason: 'Payment'
                paymentMethod: bank_transfer
                paymentDate: '2025-04-10'
          - chargeId: EF2345678
            creationDate: '2024-02-10'
            chargeType: NICS
            chargeAmount: 2200
            outstandingAmount: 0
            taxYear: 2023
            dueDate: '2024-04-01'
            outstandingInterestDue: 20.00
            accruingInterestPeriod:
              interestStartDate: '2024-05-01'
              interestEndDate: '2024-12-01'
            accruingInterestRate: 0.05
            amendments:
              - updatedChargeAmount: 2000
                amendmentDate: '2024-12-08'
                amendmentAmount: 2058.33
                amendmentReason: 'Payment'
                paymentMethod: bank_transfer
                paymentDate: '2024-12-03'
          - chargeId: KL3456789
            creationDate: '2025-05-22'
            chargeType: VATC
            chargeAmount: 1500
            outstandingAmount: 1500
            taxYear: 2025
            dueDate: '2025-07-15'
        refundDetails:
          - refundDate: '2024-01-10'
            refundMethod: bank_transfer
            refundRequestDate: '2023-12-12'
            refundRequestAmount: 350
            refundDescription: 'From overpayment from return 05 APR 23'
            interestAddedToRefund: 5.25
            totalRefundAmount: 355.25
            refundStatus: processed
        paymentHistoryDetails:
          - paymentAmount: 500
            paymentReference: PAY123456
            paymentMethod: bank_transfer
            paymentDate: '2025-04-11'
            processedDate: '2025-04-15'
            allocationReference: AB1234567
          - paymentAmount: 2058.33
            paymentReference: PAY112233
            paymentMethod: bank_transfer
            paymentDate: '2024-12-04'
            processedDate: '2024-12-08'
            allocationReference: EF2345678
          - paymentAmount: 200
            paymentReference: PAY888233
            paymentMethod: bank_transfer
            paymentDate: '2023-12-04'
            processedDate: '2023-12-08'
            allocationReference: EF2345678
